<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Parsing JSON Ke TTreeView - Grup KPPDI</title><meta name="description" content="Misalkan kita punya aplikasi yang memuat JSON dari REST Endpoint, dan kita ingin menampilkannya ke treeview, maka contoh berikut ini dapat digunakan sebagai langkah awal untuk melakukan parsing. Mari kita ikuti langkah-langkahnya: Siapkan satu buah form, pada form tersebut tambahkan satu buah panel, satu buah&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://kppdi.github.io/parsing-json-ke-ttreeview/"><link rel="alternate" type="application/atom+xml" href="https://kppdi.github.io/feed.xml"><link rel="alternate" type="application/json" href="https://kppdi.github.io/feed.json"><meta property="og:title" content="Parsing JSON Ke TTreeView"><meta property="og:image" content="https://kppdi.github.io/media/posts/96/analytics-3088958_1280.jpg"><meta property="og:site_name" content="Grup KPPDI"><meta property="og:description" content="Misalkan kita punya aplikasi yang memuat JSON dari REST Endpoint, dan kita ingin menampilkannya ke treeview, maka contoh berikut ini dapat digunakan sebagai langkah awal untuk melakukan parsing. Mari kita ikuti langkah-langkahnya: Siapkan satu buah form, pada form tersebut tambahkan satu buah panel, satu buah&hellip;"><meta property="og:url" content="https://kppdi.github.io/parsing-json-ke-ttreeview/"><meta property="og:type" content="article"><link rel="shortcut icon" href="https://kppdi.github.io/media/website/favicon-kppdi.png" type="image/png"><style>:root {
                --body-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                --heading-font: var(--body-font);
                --post-entry-font: var(--body-font);
                --logo-font: var(--body-font);
                --menu-font: var(--body-font)
            }</style><link rel="stylesheet" href="https://kppdi.github.io/assets/css/style.css?v=2da59a98f57654266b2edb505b983e39"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://kppdi.github.io/parsing-json-ke-ttreeview/"},"headline":"Parsing JSON Ke TTreeView","datePublished":"2020-08-02T17:33","dateModified":"2020-08-02T19:21","image":{"@type":"ImageObject","url":"https://kppdi.github.io/media/posts/96/analytics-3088958_1280.jpg","height":853,"width":1280},"description":"Misalkan kita punya aplikasi yang memuat JSON dari REST Endpoint, dan kita ingin menampilkannya ke treeview, maka contoh berikut ini dapat digunakan sebagai langkah awal untuk melakukan parsing. Mari kita ikuti langkah-langkahnya: Siapkan satu buah form, pada form tersebut tambahkan satu buah panel, satu buah&hellip;","author":{"@type":"Person","name":"Grup KPPDI"},"publisher":{"@type":"Organization","name":"Grup KPPDI","logo":{"@type":"ImageObject","url":"https://kppdi.github.io/media/website/kppdi-headd.png","height":72,"width":322}}}</script></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://kppdi.github.io/"><img src="https://kppdi.github.io/media/website/kppdi-headd.png" alt="Grup KPPDI"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://kppdi.github.io/" target="_self">Home</a></li><li><a href="https://kppdi.github.io/tags/docs/" target="_self">Docs</a></li><li><a href="https://kppdi.github.io/tags/tutorials/" target="_self">Tutorial</a></li><li><a href="https://kppdi.github.io/tags/sample-apps/" target="_self">Sample App</a></li><li><a href="https://kppdi.github.io/tags/files/" target="_self">Files</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2020-08-02T19:21">2 August 2020</time></div><div class="infobar__search"><form action="https://kppdi.github.io/search.html"><input type="search" name="q" placeholder=" search..."> <button type="submit" aria-label="Search"><svg width="15px" height="14px"><use xlink:href="https://kppdi.github.io/assets/svg/svg-map.svg#search"/></svg></button></form></div></div><main class="main"><article class="post"><figure class="post__featured-image"><img src="https://kppdi.github.io/media/posts/96/analytics-3088958_1280.jpg" srcset="https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-xs.jpg 300w, https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-sm.jpg 480w, https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-md.jpg 768w, https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-lg.jpg 1024w, https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-xl.jpg 1360w, https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-2xl.jpg 1600w" sizes="(max-width: 1600px) 100vw, 1600px" loading="eager" height="853" width="1280" alt=""></figure><header class="u-header post__header"><h1>Parsing JSON Ke TTreeView</h1><div class="u-header__meta u-small"><img src="https://kppdi.github.io/media/website/Logo-KPPDI.png" loading="eager" class="u-header__avatar" alt="Grup KPPDI"><div><a href="https://kppdi.github.io/authors/grup-kppdi/" title="Grup KPPDI">Grup KPPDI</a> <time datetime="2020-08-02T17:33">2 August 2020 </time><a href="https://kppdi.github.io/tags/delphi/" class="u-tag u-tag--1">Delphi</a></div></div></header><div class="post__entry u-inner"><p>Misalkan kita punya aplikasi yang memuat JSON dari REST Endpoint, dan kita ingin menampilkannya ke treeview, maka contoh berikut ini dapat digunakan sebagai langkah awal untuk melakukan parsing. Mari kita ikuti langkah-langkahnya:</p><p>Siapkan satu buah form, pada form tersebut tambahkan satu buah panel, satu buah treeview buah dan satu buah memo. Pada panel tambahkan satu buah tombol, dan atur posisi komponen-komponen tersebut seperti contoh gambar berikut:</p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96//Screen-Shot-2020-08-02-at-17.25.20.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-xs.png 300w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-sm.png 480w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-md.png 768w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-lg.png 1024w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-xl.png 1360w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.25.20-2xl.png 1600w" alt="" width="1514" height="888"></figure><p>Kemudian, sebelum coding, perlu disiapkan library yang dibutuhkan, yaitu <strong>SuperObject</strong>, yang merupakan JSON library favorit saya. Library ini sudah disiapkan bersama source code contoh aplikasi ini.</p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96//Screen-Shot-2020-08-02-at-17.32.15.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-xs.png 300w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-sm.png 480w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-md.png 768w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-lg.png 1024w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-xl.png 1360w, https://kppdi.github.io/media/posts/96//responsive/Screen-Shot-2020-08-02-at-17.32.15-2xl.png 1600w" alt="" width="1236" height="542"></figure><p>Â </p><p>Untuk menggunakan library tersebut, tambahkan SuperObject.pas ke project:</p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96/Screen-Shot-2020-08-02-at-17.35.04.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-xs.png 300w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-sm.png 480w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-md.png 768w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-lg.png 1024w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-xl.png 1360w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.04-2xl.png 1600w" alt="" width="1034" height="420"></figure><p>Dan pilih SuperObject.pas</p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96/Screen-Shot-2020-08-02-at-17.35.27-2.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-xs.png 300w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-sm.png 480w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-md.png 768w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-lg.png 1024w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-xl.png 1360w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.35.27-2-2xl.png 1600w" alt="" width="1128" height="900"></figure><p>Kemudian tambahkan SuperObject ke klausa uses:</p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96/Screen-Shot-2020-08-02-at-17.36.51.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-xs.png 300w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-sm.png 480w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-md.png 768w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-lg.png 1024w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-xl.png 1360w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-17.36.51-2xl.png 1600w" alt="" width="1196" height="358"></figure><p>Â </p><p>Property Text dari Memo1 dapat diganti dengan default JSON text, misalnya:</p><div><div><code>{</code></div><div><code>Â Â "id": "0001",</code></div><div><code>Â Â "type": "donut",</code></div><div><code>Â Â "name": "Cake",</code></div><div><code>Â Â "ppu": 0.55,</code></div><div><code>Â Â "batters":</code></div><div><code>Â Â Â Â {</code></div><div><code>Â Â Â Â Â Â "batter":</code></div><div><code>Â Â Â Â Â Â Â Â [</code></div><div><code>Â Â Â Â Â Â Â Â Â Â { "id": "1001", "type": "Regular" },</code></div><div><code>Â Â Â Â Â Â Â Â Â Â { "id": "1002", "type": "Chocolate" },</code></div><div><code>Â Â Â Â Â Â Â Â Â Â { "id": "1003", "type": "Blueberry" },</code></div><div><code>Â Â Â Â Â Â Â Â Â Â { "id": "1004", "type": "Devil's Food" }</code></div><div><code>Â Â Â Â Â Â Â Â ]</code></div><div><code>Â Â Â Â },</code></div><div><code>Â Â "topping":</code></div><div><code>Â Â Â Â [</code></div><div><code>Â Â Â Â Â Â { "id": "5001", "type": "None" },</code></div><div><code>Â Â Â Â Â Â { "id": "5002", "type": "Glazed" },</code></div><div><code>Â Â Â Â Â Â { "id": "5005", "type": "Sugar" },</code></div><div><code>Â Â Â Â Â Â { "id": "5007", "type": "Powdered Sugar" },</code></div><div><code>Â Â Â Â Â Â { "id": "5006", "type": "Chocolate with Sprinkles" },</code></div><div><code>Â Â Â Â Â Â { "id": "5003", "type": "Chocolate" },</code></div><div><code>Â Â Â Â Â Â { "id": "5004", "type": "Maple" }</code></div><div><code>Â Â Â Â ]</code></div><div><code>}</code></div></div><p>Â </p><p>Klik ganda pada tombol caption <strong>Parse</strong>, kemudian isikan kode seperti berikut:</p><p><code>var<br>Â  s, v: string;<br>Â  curv,<br>Â  iso: ISuperObject;<br>Â  item: TSuperObjectIter;<br>Â  tvi: TTreeNode;<br>begin<br>Â  s := Memo1.Text;<br>Â  TreeView1.Items.BeginUpdate;<br>Â  try<br>Â  Â  TreeView1.Items.Clear;<br>Â  Â  tvi := TreeView1.Items.AddFirst(nil, 'Parsed Data:');<br>Â  Â  if (s = '') or (s = '{}') then<br>Â  Â  begin<br>Â  Â  Â  TreeView1.Items.AddChild(tvi, 'Tidak ada data...');<br>Â  Â  end<br>Â  Â  else<br>Â  Â  begin<br>Â  Â  Â  iso := so(s);<br>Â  Â  Â  ParseItemsIntoTreeView(tvi, iso);<br>Â  Â  end;<br>Â  finally<br>Â  Â  TreeView1.Items.EndUpdate;<br>Â  Â  TreeView1.Items[0].Expand(false);<br>Â  Â  TreeView1.Items[0].MakeVisible;<br>Â  end;<br>end;</code></p><p>Kode di atas membuat node pertama bernama <strong>tvi</strong> dengan caption "Parsed Data:" jika teks pada Memo1 tidak kosong. Teks kemudian diparse ke JSON object pada variabel <strong>iso</strong>:</p><p><code>iso := so(s);</code></p><p>Lalu JSON ini ditelusuri item-itemnya dan dimuat ke treeview dengan menginduk ke node pertama, yaitu <strong>tvi</strong></p><p><code>ParseItemsIntoTreeView(tvi, iso);</code></p><p>Berikut fungsi parse JSON ke treeview:</p><p><code>procedure TForm1.ParseItemsIntoTreeView(<br>Â  node: TTreeNode; itemData: ISuperObject);<br>var<br>Â  curv: ISuperObject;<br>Â  cura: TSuperArray;<br>Â  item: TSuperObjectIter;<br>Â  tvi: TTreeNode;<br>Â  s, v, dv: string;<br>Â  i: integer;<br>begin<br>Â  try<br>Â  Â  if ObjectFindFirst(itemData, item) then<br>Â  Â  repeat<br>Â  Â  Â  s := item.key;<br>Â  Â  Â  v := '';<br>Â  Â  Â  if item.val.IsType(stString) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString;<br>Â  Â  Â  Â  dv := copy(v,1,10);<br>Â  Â  Â  Â  // '2020-06-04'<br>Â  Â  Â  Â  if<br>Â  Â  Â  Â  Â  (length(dv)&gt;=10) and<br>Â  Â  Â  Â  Â  (dv[5] = '-') and (dv[8] = '-') and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,1,4) ,0)) = copy(dv,1,4)) and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,6,2) ,0),2) = copy(dv,6,2)) and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,9,2) ,0),2) = copy(dv,9,2))<br>Â  Â  Â  Â  then<br>Â  Â  Â  Â  begin<br>Â  Â  Â  Â  Â  TreeView1.Items.AddChild(<br>Â  Â  Â  Â  Â  Â  node,<br>Â  Â  Â  Â  Â  Â  s+': '+DateIndoShort(DateFromSQL(dv))+' '+<br>Â  Â  Â  Â  Â  Â  Â  copy(v,11,length(v))<br>Â  Â  Â  Â  Â  )<br><br>Â  Â  Â  Â  end<br>Â  Â  Â  Â  else<br>Â  Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stBoolean) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := BoolToStr(item.val.AsBoolean, true);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stInt) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr( item.val.AsInteger);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stDouble) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr( item.val.AsDouble);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stCurrency) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr (item.val.AsCurrency);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stNull) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := '';<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stObject) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString();<br>Â  Â  Â  Â  tvi := TreeView1.Items.AddChild(node, s+':');<br>Â  Â  Â  Â  ParseItemsIntoTreeView(tvi, item.val);<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stArray) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString();<br>Â  Â  Â  Â  cura := item.val.AsArray;<br>Â  Â  Â  Â  tvi := TreeView1.Items.AddChild(node, s+':');<br>Â  Â  Â  Â  for i := 0 to cura.Length-1 do<br>Â  Â  Â  Â  begin<br>Â  Â  Â  Â  Â  ParseItemsIntoTreeView(<br>Â  Â  Â  Â  Â  Â  TreeView1.Items.AddChild(tvi, _s(i+1)+'.:'),<br>Â  Â  Â  Â  Â  Â  cura[i]<br>Â  Â  Â  Â  Â  );<br>Â  Â  Â  Â  end;<br>Â  Â  Â  end;<br>Â  Â  until not ObjectFindNext(item);<br>Â  finally<br><br>Â  end;<br>end;</code></p><p>Â </p><figure class="post__image"><img loading="lazy" src="https://kppdi.github.io/media/posts/96/Screen-Shot-2020-08-02-at-18.10.56.png" sizes="(max-width: 48em) 100vw, 768px" srcset="https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-xs.png 300w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-sm.png 480w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-md.png 768w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-lg.png 1024w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-xl.png 1360w, https://kppdi.github.io/media/posts/96/responsive/Screen-Shot-2020-08-02-at-18.10.56-2xl.png 1600w" alt="" width="1622" height="1054"></figure><p>Â </p><p>Beberapa fungsi bantu dapat Anda lihat pada listing lengkap berikut:</p><p><code>unit Unit1;<br><br>interface<br><br>uses<br>Â  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,<br>Â  System.Classes, Vcl.Graphics,<br>Â  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls,<br>Â  Vcl.ExtCtrls, Vcl.ComCtrls, SuperObject;<br><br>type<br>Â  TForm1 = class(TForm)<br>Â  Â  Memo1: TMemo;<br>Â  Â  TreeView1: TTreeView;<br>Â  Â  Panel1: TPanel;<br>Â  Â  Button2: TButton;<br>Â  Â  procedure Button2Click(Sender: TObject);<br>Â  private<br>Â  Â  { Private declarations }<br>Â  Â  procedure ParseItemsIntoTreeView(node: TTreeNode; itemData: ISuperObject);<br>Â  Â  function _s(i: integer; padLeftWith0Count: integer = 0): string;<br>Â  Â  function _i(s: String; default: integer = 0): Integer;<br>Â  Â  function Â DateFromSQL(const ASQLDate: String): TDateTime;<br>Â  Â  function Â DateIndoShort (const ADate: TDate):String;<br>Â  public<br>Â  Â  { Public declarations }<br>Â  end;<br><br>var<br>Â  Form1: TForm1;<br><br>implementation<br><br>{$R *.dfm}<br><br>procedure TForm1.Button2Click(Sender: TObject);<br>var<br>Â  s, v: string;<br>Â  curv,<br>Â  iso: ISuperObject;<br>Â  item: TSuperObjectIter;<br>Â  tvi: TTreeNode;<br>begin<br>Â  s := Memo1.Text;<br>Â  TreeView1.Items.BeginUpdate;<br>Â  try<br>Â  Â  TreeView1.Items.Clear;<br>Â  Â  tvi := TreeView1.Items.AddFirst(nil, 'Parsed Data:');<br>Â  Â  tvi.ImageIndex := 0;<br>Â  Â  if (s = '') or (s = '{}') then<br>Â  Â  begin<br>Â  Â  Â  TreeView1.Items.AddChild(tvi, 'Tidak ada data...').ImageIndex := 5;<br>Â  Â  end<br>Â  Â  else<br>Â  Â  begin<br>Â  Â  Â  iso := so(s);<br>Â  Â  Â  ParseItemsIntoTreeView(tvi, iso);<br>Â  Â  end;<br>Â  finally<br>Â  Â  TreeView1.Items.EndUpdate;<br>Â  Â  TreeView1.Items[0].Expand(false);<br>Â  Â  TreeView1.Items[0].MakeVisible;<br>Â  end;<br>end;<br><br>function TForm1.DateFromSQL(const ASQLDate: String): TDateTime;<br>begin<br>Â  try<br>Â  Â  Result := EncodeDate(<br>Â  Â  Â  _i(Copy(ASQLDate,1,4)),<br>Â  Â  Â  _i(Copy(ASQLDate,6,2)),<br>Â  Â  Â  _i(Copy(ASQLDate,9,2))<br>Â  Â  );<br>Â  except<br>Â  Â  Result := Date();<br>Â  end;<br>end;<br><br>function TForm1.DateIndoShort(const ADate: TDate): String;<br>begin<br>Â  Result := FormatDateTime('dd/MM/yyyy', ADate);<br>end;<br><br>procedure TForm1.ParseItemsIntoTreeView(<br>Â  node: TTreeNode; itemData: ISuperObject);<br>var<br>Â  curv: ISuperObject;<br>Â  cura: TSuperArray;<br>Â  item: TSuperObjectIter;<br>Â  tvi: TTreeNode;<br>Â  s, v, dv: string;<br>Â  i: integer;<br>begin<br>Â  try<br>Â  Â  if ObjectFindFirst(itemData, item) then<br>Â  Â  repeat<br>Â  Â  Â  s := item.key;<br>Â  Â  Â  v := '';<br>Â  Â  Â  if item.val.IsType(stString) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString;<br>Â  Â  Â  Â  dv := copy(v,1,10);<br>Â  Â  Â  Â  // '2020-06-04'<br>Â  Â  Â  Â  if<br>Â  Â  Â  Â  Â  (length(dv)&gt;=10) and<br>Â  Â  Â  Â  Â  (dv[5] = '-') and (dv[8] = '-') and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,1,4) ,0)) = copy(dv,1,4)) and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,6,2) ,0),2) = copy(dv,6,2)) and<br>Â  Â  Â  Â  Â  (_s(_i( copy(dv,9,2) ,0),2) = copy(dv,9,2))<br>Â  Â  Â  Â  then<br>Â  Â  Â  Â  begin<br>Â  Â  Â  Â  Â  TreeView1.Items.AddChild(<br>Â  Â  Â  Â  Â  Â  node,<br>Â  Â  Â  Â  Â  Â  s+': '+DateIndoShort(DateFromSQL(dv))+' '+<br>Â  Â  Â  Â  Â  Â  Â  copy(v,11,length(v))<br>Â  Â  Â  Â  Â  )<br><br>Â  Â  Â  Â  end<br>Â  Â  Â  Â  else<br>Â  Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stBoolean) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := BoolToStr(item.val.AsBoolean, true);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stInt) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr( item.val.AsInteger);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stDouble) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr( item.val.AsDouble);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stCurrency) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := FloatToStr (item.val.AsCurrency);<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stNull) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := '';<br>Â  Â  Â  Â  TreeView1.Items.AddChild(node, s+': '+v)<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stObject) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString();<br>Â  Â  Â  Â  tvi := TreeView1.Items.AddChild(node, s+':');<br>Â  Â  Â  Â  ParseItemsIntoTreeView(tvi, item.val);<br>Â  Â  Â  end<br>Â  Â  Â  else<br>Â  Â  Â  if item.val.IsType(stArray) then<br>Â  Â  Â  begin<br>Â  Â  Â  Â  v := item.val.AsString();<br>Â  Â  Â  Â  cura := item.val.AsArray;<br>Â  Â  Â  Â  tvi := TreeView1.Items.AddChild(node, s+':');<br>Â  Â  Â  Â  for i := 0 to cura.Length-1 do<br>Â  Â  Â  Â  begin<br>Â  Â  Â  Â  Â  ParseItemsIntoTreeView(<br>Â  Â  Â  Â  Â  Â  TreeView1.Items.AddChild(tvi, _s(i+1)+'.:'),<br>Â  Â  Â  Â  Â  Â  cura[i]<br>Â  Â  Â  Â  Â  );<br>Â  Â  Â  Â  end;<br>Â  Â  Â  end;<br>Â  Â  until not ObjectFindNext(item);<br>Â  finally<br><br>Â  end;<br>end;<br><br>function TForm1._i(s: String; default: integer = 0): Integer;<br>begin<br>Â  Result := StrToIntDef(s, default);<br>end;<br><br>function TForm1._s(i: integer; padLeftWith0Count: integer = 0): string;<br>begin<br>Â  Result := IntToStr(i);<br>Â  if padLeftWith0Count&gt; 0 then<br>Â  begin<br>Â  Â  while length(Result)&lt;padLeftWith0Count do<br>Â  Â  Â  Result := '0' + Result;<br>Â  end;<br>end;<br><br>end.<br></code></p><p>Â </p><p>Source code dapat diunduh di<br><a href="https://github.com/kppdi/ParseJSONToTreeView" target="_blank" rel="noopener noreferrer">https://github.com/kppdi/ParseJSONToTreeView</a></p><p><code></code><code></code></p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on 2 August 2020</div><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkppdi.github.io%2Fparsing-json-ke-ttreeview%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer" aria-label="Share with Facebook"><svg class="u-icon"><use xlink:href="https://kppdi.github.io/assets/svg/svg-map.svg#facebook"/></svg> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fkppdi.github.io%2Fparsing-json-ke-ttreeview%2F&amp;media=https%3A%2F%2Fkppdi.github.io%2Fmedia%2Fposts%2F96%2Fanalytics-3088958_1280.jpg&amp;description=Parsing%20JSON%20Ke%20TTreeView" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer" aria-label="Share with Pinterest"><svg class="u-icon"><use xlink:href="https://kppdi.github.io/assets/svg/svg-map.svg#pinterest"/></svg> </a><a href="https://wa.me/?text=Parsing%20JSON%20Ke%20TTreeView https%3A%2F%2Fkppdi.github.io%2Fparsing-json-ke-ttreeview%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer" title="Share with WhatsApp" aria-label="Share with WhatsApp"><svg class="u-icon"><use xlink:href="https://kppdi.github.io/assets/svg/svg-map.svg#whatsapp"/></svg> </a><a href="http://www.linkedin.com/shareArticle?url=https%3A%2F%2Fkppdi.github.io%2Fparsing-json-ke-ttreeview%2F&amp;title=Parsing%20JSON%20Ke%20TTreeView" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer" aria-label="Share with LinkedIn"><svg class="u-icon"><use xlink:href="https://kppdi.github.io/assets/svg/svg-map.svg#linkedin"/></svg></a></div></aside><footer class="post__footer"><ul class="post__tag box"><li><a href="https://kppdi.github.io/tags/delphi/" class="u-tag u-tag--1" title="Delphi">Delphi</a></li><li><a href="https://kppdi.github.io/tags/sample-apps/" class="u-tag u-tag--1" title="Sample App">Sample App</a></li><li><a href="https://kppdi.github.io/tags/tutorials/" class="u-tag u-tag--1" title="Tutorial">Tutorial</a></li></ul><div class="post__bio box"><img class="u-author__avatar" src="https://kppdi.github.io/media/website/Logo-KPPDI.png" loading="lazy" alt="Grup KPPDI"><div><h4 class="h6"><a href="https://kppdi.github.io/authors/grup-kppdi/" title="Grup KPPDI">Grup KPPDI</a></h4></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://kppdi.github.io/resize-gambar-jpg-and-bmp-menggunakan-delphi/" class="post__nav__link" rel="prev"><img src="https://kppdi.github.io/media/posts/5/responsive/scalimg-codegear-delphi-for-microsoft-windows-umain-running_2011-06-24_00-26-54-2-xs.png" loading="lazy" alt=""><div class="u-small">Previous Post<h5>Resize Gambar (JPG &amp; BMP) Menggunakan Delphi</h5></div></a></div></nav></footer></article><div class="comments box"><h3 class="box__title">Comments</h3><div id="disqus_thread"></div><script>var disqus_config = function () {
                    this.page.url = 'https://kppdi.github.io/parsing-json-ke-ttreeview/';
            		this.page.identifier = '96';
                    this.page.title = ' Parsing JSON Ke TTreeView';
                };
            
                var disqus_loaded = false;
            
                function publiiLoadDisqus() {
                    if(disqus_loaded) {
                        return false;
                    }
            
                    var top = document.getElementById('disqus_thread').offsetTop;
            
                    if (!disqus_loaded && (window.scrollY || window.pageYOffset) + window.innerHeight > top) {
                        disqus_loaded = true;
            
                        (function () {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://kppdi-group.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    }
                }
            
                publiiLoadDisqus();
            
                window.onscroll = function() {
                    publiiLoadDisqus();
                };</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></div></main><div class="sidebar"><section class="box featured"><h3 class="box__title">Featured</h3><ul class="featured__container"><li class="featured__item"><a href="https://kppdi.github.io/parsing-json-ke-ttreeview/" class="featured__image-link"><img src="https://kppdi.github.io/media/posts/96/responsive/analytics-3088958_1280-xs.jpg" alt=""></a><div><a href="https://kppdi.github.io/parsing-json-ke-ttreeview/" class="featured__title">Parsing JSON Ke TTreeView</a> <time class="u-small" datetime="2020-08-02T17:33">2 August 2020</time></div></li><li class="featured__item"><a href="https://kppdi.github.io/screen-capture-menggunakan-delphi/" class="featured__image-link"><img src="https://kppdi.github.io/media/posts/4/responsive/winsnap_delphi_snapshot_screen_caputure-xs.png" alt=""></a><div><a href="https://kppdi.github.io/screen-capture-menggunakan-delphi/" class="featured__title">Screen Capture Menggunakan Delphi</a> <time class="u-small" datetime="2020-08-01T17:15">1 August 2020</time></div></li></ul></section><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><a href="https://kppdi.github.io/authors/grup-kppdi/" class="authors__image-link"><img src="https://kppdi.github.io/media/website/Logo-KPPDI.png" alt="Grup KPPDI"></a><div><a href="https://kppdi.github.io/authors/grup-kppdi/" class="authors__title">Grup KPPDI</a> <span class="u-small">Post: 34</span></div></li></ul></section><section class="box"><h3 class="box__title">Tags</h3><ul class="tags"><li><a href="https://kppdi.github.io/tags/adeisti/">Adeisti</a> <span class="u-small">(1)</span></li><li><a href="https://kppdi.github.io/tags/akuntansi/">Akuntansi</a> <span class="u-small">(1)</span></li><li><a href="https://kppdi.github.io/tags/angka/">Angka</a> <span class="u-small">(1)</span></li><li><a href="https://kppdi.github.io/tags/aplikasi/">aplikasi</a> <span class="u-small">(0)</span></li><li><a href="https://kppdi.github.io/tags/blob/">BLOB</a> <span class="u-small">(1)</span></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://kppdi.github.io/"><img src="https://kppdi.github.io/media/website/kppdi-headd.png" alt="Grup KPPDI"></a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright"><p>Powered by <a href="https://facebook.com/groups/kppdi" title="Grup KPPDI" target="_blank" rel="noopener">Grup KPPDI</a></p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://kppdi.github.io/assets/js/scripts.min.js?v=225cfb4a7e546edee710c4f1208e81e2"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>